{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-4">Bookmarked Posts-Inator!</h2>

  {% if posts %}
    {% for post in posts %}
      <div class="card mb-3 shadow-sm">
        <div class="card-body">
          <h5><a href="/@{{ post.user }}">@{{ post.user }}</a></h5>
          <small class="text-muted">{{ post.time|convert_time }}</small>
          <p class="mt-2">{{ post.text }}</p>

          {% if post.tags %}
          <p><small>Tags:
            {% for tag in post.tags %}
              <span class="badge bg-secondary">{{ tag }}</span>
            {% endfor %}
          </small></p>
          {% endif %}

          <!-- Like Button -->
          <form class="d-inline like-form" data-post-id="{{ post.doc_id }}" action="{{ url_for('posts.like', post_id=post.doc_id) }}" method="post">
            <button type="submit" class="btn btn-sm like-btn {% if post.liked %}btn-primary{% else %}btn-outline-primary{% endif %}">
              Like (<span class="like-count">{{ post.likes }}</span>)
            </button>
          </form>

          <!-- Bookmark Button -->
          <form class="d-inline bookmark-form" data-post-id="{{ post.doc_id }}" action="{{ url_for('posts.bookmark', post_id=post.doc_id) }}" method="post">
            <button type="submit" class="btn btn-sm bookmark-btn {% if post.bookmarked %}btn-warning{% else %}btn-outline-warning{% endif %}">
              Bookmark
            </button>
          </form>

          <!-- View Comments -->
          <a href="{{ url_for('posts.view_post', post_id=post.doc_id) }}" class="btn btn-sm btn-link mt-1">
            View Comments ({{ post.comments|length|default(0) }})
          </a>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p>You haven't bookmarked any posts yet.</p>
  {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/like_bookmark.js') }}"></script>
{% endblock %}
