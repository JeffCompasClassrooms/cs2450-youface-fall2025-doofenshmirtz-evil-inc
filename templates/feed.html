{% extends "base.html" %}

{% block content %}
<div class="container mt-4">

  <!-- Welcome Header -->
  <div class="text-center mb-4">
    <h1>Welcome, {{ username }}!</h1>
  </div>

  <div class="row">

    <!-- Main Feed Column -->
    <div class="col-lg-8">

      <!-- New Post Card -->
      <div class="card mb-4 shadow-sm">
        <div class="card-body">
          <h4 class="card-title">New Post</h4>
          <form method="post" action="/post">
            <div class="form-group mb-2">
              <textarea class="form-control" name="post" rows="3" placeholder="What's on your mind?"></textarea>
            </div>
            <div class="form-group mb-2">
              <input type="text" class="form-control" name="tags" placeholder="Add tags (comma-separated)">
            </div>
            <button type="submit" class="btn btn-primary">Post</button>
          </form>
        </div>
      </div>

      <!-- Feed Posts -->
      <h3 class="mb-3">My Feed</h3>
      {% for post in posts %}
      <div class="card mb-3 shadow-sm">
        <div class="card-body">
          <h5>
            <a href="/@{{ post.handle }}">@{{ post.handle }}</a>
          </h5>
          <small class="text-muted">{{ post.time|convert_time }}</small>
          <p class="mt-2">{{ post.text }}</p>
          {% if post.tags %}
          <p>
            <small>Tags:
              {% for tag in post.tags %}
                <span class="badge bg-secondary">{{ tag }}</span>
              {% endfor %}
            </small>
          </p>
          {% endif %}
        </div>
      </div>
      {% endfor %}

    </div>

    <!-- Sidebar Column -->
    <div class="col-lg-4">

      <!-- Add Friend -->
      <div class="card mb-4 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Add Friend</h5>
          <form method="post" action="/addfriend">
            <div class="form-group mb-2">
              <input type="text" class="form-control" name="name" placeholder="Username">
            </div>
            <button type="submit" class="btn btn-primary btn-sm">Add Friend</button>
          </form>
        </div>
      </div>

      <!-- Friends List -->
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title">My Friends</h5>
          {% if friends %}
          <ul class="list-group list-group-flush">
            {% for friend in friends %}
            <li class="list-group-item">
              <a href="/@{{ friend.handle }}">{{ friend.handle }}</a>
            </li>
            {% endfor %}
          </ul>
          {% else %}
          <p class="text-muted">You have no friends yet.</p>
          {% endif %}
        </div>
      </div>

    </div>
  </div>

</div>
{% endblock %}
